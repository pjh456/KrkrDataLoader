# KrkrDataLoader
一个尚未完成的项目，用于简便地处理Krkr引擎解包出来的剧情文件

未来也许会有一些功能上的扩展，都是我现在已经实现，但是接口太丑陋的东西。

## 主要功能：

### 将 ".ks.scn" 格式文件批量处理为 ".ks.json" 格式文件

用到了解包工具 FreeMoteToolkit，加了点 subprocess 的部分用于自动化处理文件，而不必一个个手动拖拽解包。

###### 实际上已经有一个写好的版本了，但是当时没想过开源，所以就写得很难维护。实际上都是些简单的东西，只不过把重复劳动的过程简化了而已。等我啥时候把它改得易维护之后就端上来。

### 将 ".ks.json" 格式文件的内容转化为对象，以实现对其内容的高效处理

我实现了两个类，分别是 Scene 和 Datas。

#### Scene

每一幕的剧情在源文件中被分隔开来，以便于实现选择支的切换和场景的跳转。可以使用 Scene.goto() 得知其指向的下一个场景。

#### Datas

一整个 ".ks.json" 格式文件。为了方便各幕之间的管理，我将每一幕单独丢进类里套娃实现了。

可以使用 Datas[] 来便捷地调用这些 Scene 对象。

其他功能火热实现中。

###### 已经在写了，只不过功能上还有什么可以简化的部分我还在想，所以可能可用版本的推出会稍微晚点。

## 开源动机(?)

解包 Krkr2 引擎游戏的剧情、拿音频去练模型的时候遇到了些麻烦，浪费了许多时间在写这些神秘脚本上。

抱着前人种树后人乘凉的想法先把这个实现了，万一哪天被人刨坟也欢迎 pull。

Ciallo～(∠・ω< )⌒☆

## 未来可能实现

### 长音频剧本合成
把一整个文件的剧情合成为一个长音频（改进后也许含背景音乐？），用于当广播剧听之类的，省去了许多社死的可能性(?)。

这个是我现在正在实现的，不过对于哑巴角色和旁白的语音还在考虑要不要用 TTS 实现，开销稍微有点大。

### 对于新引擎加密的解密

新作用的加密方式不同，导致 Krkrextract 没办法正常解包，必须得靠 KrkrzExtract/KrkrDump/KrkrPatch 等工具读取的同时解包文件。

这样子不仅麻烦，文件还没办法像之前一样被分好类。而后两个工具更是无法解包音频文件。

正在学习逆向工程，万一哪天开窍了就上手把解包工具升级一下。

Comming not soon......
